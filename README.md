# RivAgent
## 概要
**RivAgent**は、[ANAC2025](https://scml.cs.brown.edu/)のANLリーグ向けに開発した交渉エージェントです。ANAC2025は自動交渉に関するコンテストであり、ANLリーグでは複数エージェントとの交渉問題を扱っています。本エージェントは、各交渉に対して将来の交渉も考慮した最終的な効用の期待値を計算し、相手の提案傾向も考慮する戦略をとります。READMEでは戦略について簡単に説明するが、詳細の仕様は`rivagent/report/out/rivagent.pdf` に書いてあります。

## 特徴
- ECU（Expected Center Utility）による将来性を考慮した評価
- OAP（Opponent’s Acceptance Probability）による相手の受容可能性推定
- 相手の提案傾向に基づく時間依存的な譲歩戦略
- 過去の提案履歴を活用し、閾値調整と相手の好む提案を学習

## コア戦略構成
### OAP（Opponent's Acceptance Probability）
相手の提案の多様性から、相手が提案を受け入れそうな確率を推定し、提案戦略や受け入れ戦略に活用します。

### ECU（Expected Center Utility）
交渉全体におけるグローバルな最適性を導くため、各提案に対して将来の提案を含めた期待値を計算します。

### 時間ベースの譲歩戦略
交渉の進捗に応じて、許容できる提案範囲（閾値）を動的に調整します。

### 提案戦略
ECUが許容範囲にある候補の中から、選好の多様性を高めるように提案を選択します。

### 受け入れ戦略
相手の提案が設定された最小閾値を超えた場合にのみ受け入れを行います。

## 評価実験
RivAgentは、AMR 2025の3つのシナリオ（Dinners、Target Quantity、Job Hunt）で性能を比較評価しました。評価指標に関しては、1000トーナメント行った結果を四分位範囲（小さい順に`Min`,`Q1`,`Mean`,`Q3`,`Max`）で表しています。また比較したエージェントは時間が経つにつれて譲歩するエージェント（`Boulware2025`,`Linear2025`,`Conceder2025`）と最良な提案しかしないエージェント`Random2025`です。それぞれのエージェントは、`Boulware2025`,`Linear2025`,`Conceder2025`の順で譲歩速度が遅いです。

### Dinnersシナリオの性能 (1000トーナメント)

| Agent        | Min     | Q1      | Mean    | Q3      | Max     |
|--------------|---------|---------|---------|---------|---------|
| RivAgent     | **1.050** | **7.018** | **12.045** | **16.002** | **47.600** |
| Boulware2025 | 0.630   | 6.420   | 10.589  | 13.000  | 42.000  |
| Linear2025   | 0.840   | 6.420   | 10.599  | 13.000  | 42.000  |
| Conceder2025 | 0.840   | 6.210   | 10.268  | 12.465  | 42.000  |
| Random2025   | 0.390   | 3.477   | 5.118   | 6.608   | 14.000  |

### Target Quantityシナリオの性能 (1000トーナメント)

| Agent        | Min     | Q1      | Mean    | Q3      | Max     |
|--------------|---------|---------|---------|---------|---------|
| RivAgent     | 8.150   | 11.750  | **19.169** | **26.262** | **58.000** |
| Boulware2025 | **8.550** | **12.600** | 18.719  | 23.300  | 53.200  |
| Linear2025   | 6.500   | 11.700  | 17.201  | 22.000  | 47.200  |
| Conceder2025 | 7.600   | 11.050  | 16.247  | 20.625  | 46.400  |
| Random2025   | 4.000   | 5.450   | 9.479   | 12.050  | 25.600  |

### Job Huntシナリオの性能(1000トーナメント)

| Agent        | Min     | Q1      | Mean    | Q3      | Max     |
|--------------|---------|---------|---------|---------|---------|
| RivAgent     | 7.271   | 12.442  | **81.447** | **120.859** | **336.000** |
| Boulware2025 | 8.608   | **12.835** | 78.455  | 120.731 | 336.000 |
| Linear2025   | **8.738** | 12.183  | 72.858  | 120.578 | 336.000 |
| Conceder2025 | 4.333   | 9.893   | 72.899  | 118.643 | 336.000 |
| Random2025   | 3.583   | 5.719   | 52.931  | 87.562  | 256.800 |
